#!/bin/bash

##############################################################################
# Kindle Dashboard Configuration File
#
# This file contains configuration settings for the fetch-dashboard.sh script
# Edit these values to match your network and server setup
#
# Note: This file is sourced by the fetch script, so use bash syntax
##############################################################################

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Dashboard server hostname or IP address
# Change this to your server's IP address on the local network
# Default: Raspberry Pi production server
SERVER_HOST="192.168.50.163"

# Dashboard server port
SERVER_PORT="3000"

# Network timeout in seconds for HTTP requests
TIMEOUT="30"

# Number of retry attempts for failed downloads
RETRIES="3"

# =============================================================================
# KINDLE PATHS CONFIGURATION
# =============================================================================

# Directory where dashboard images and logs are stored
# This should be on the Kindle's USB storage area
DASHBOARD_DIR="/mnt/us/dashboard"

# Log file path for troubleshooting
LOG_FILE="/mnt/us/dashboard/logs/fetch.log"

# Backup/fallback image to display if download fails
# This should be a valid 600x800 PNG image
BACKUP_IMAGE="/mnt/us/dashboard/fallback.png"

# =============================================================================
# DISPLAY CONFIGURATION
# =============================================================================

# Default refresh type for image display
# Options: "full" (complete refresh, slower but cleaner)
#          "partial" (faster but may leave ghosting)
DEFAULT_REFRESH_TYPE="full"

# Force full refresh every N updates to prevent ghosting
# Set to 0 to disable periodic full refresh
FULL_REFRESH_INTERVAL="5"

# =============================================================================
# BEHAVIOR CONFIGURATION
# =============================================================================

# Enable verbose logging by default
# Set to "true" for detailed logs, "false" for minimal output
VERBOSE_LOGGING="false"

# Include test grid in dashboard requests
# Useful for alignment testing and debugging
INCLUDE_TEST_GRID="false"

# Automatically backup previous image before downloading new one
AUTO_BACKUP="true"

# Maximum log file size in KB (0 = no limit)
# When exceeded, log will be rotated
MAX_LOG_SIZE="1024"

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Enable network connectivity check before attempting download
CHECK_CONNECTIVITY="true"

# Ping timeout for connectivity test (seconds)
PING_TIMEOUT="5"

# User agent string for HTTP requests
USER_AGENT="Kindle-Dashboard/1.0"

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================

# Custom wget options (advanced users only)
# These options will be added to the wget command
# Example: "--header='Authorization: Bearer token'"
WGET_EXTRA_OPTIONS=""

# Image verification settings
VERIFY_DOWNLOADED_IMAGE="true"

# Minimum expected file size for valid dashboard image (bytes)
MIN_IMAGE_SIZE="1024"

# Maximum expected file size for dashboard image (bytes)
# Set to 0 to disable size check
MAX_IMAGE_SIZE="102400"

# =============================================================================
# SCHEDULED EXECUTION CONFIGURATION
# =============================================================================

# These settings are used when the script is run via cron or scheduled tasks

# Quiet mode for scheduled runs (reduces output)
SCHEDULED_QUIET_MODE="true"

# Force refresh for scheduled runs (ignores server cache)
SCHEDULED_FORCE_REFRESH="false"

# Log rotation for scheduled runs
SCHEDULED_LOG_ROTATION="true"

# =============================================================================
# DEBUGGING CONFIGURATION
# =============================================================================

# Enable debug mode (very verbose logging)
DEBUG_MODE="false"

# Save raw HTTP responses for debugging
SAVE_HTTP_RESPONSES="false"

# Debug output directory
DEBUG_DIR="/mnt/us/dashboard/debug"

# Keep temporary files for debugging
KEEP_TEMP_FILES="false"

##############################################################################
# ENVIRONMENT-SPECIFIC OVERRIDES
##############################################################################

# Uncomment and modify these sections for specific environments

# --- DEVELOPMENT ENVIRONMENT ---
# Uncomment for testing with local development server
# SERVER_HOST="localhost"
# SERVER_PORT="3001"
# VERBOSE_LOGGING="true"
# DEBUG_MODE="true"

# --- PRODUCTION ENVIRONMENT ---
# Uncomment for production deployment
# SCHEDULED_QUIET_MODE="true"
# VERIFY_DOWNLOADED_IMAGE="true"
# AUTO_BACKUP="true"

# --- TESTING ENVIRONMENT ---
# Uncomment for testing and debugging
# INCLUDE_TEST_GRID="true"
# VERBOSE_LOGGING="true"
# KEEP_TEMP_FILES="true"
# SAVE_HTTP_RESPONSES="true"

##############################################################################
# NOTES AND EXAMPLES
##############################################################################

# To find your server's IP address, run on the server machine:
#   ip addr show | grep "inet " | grep -v 127.0.0.1
#   # or
#   hostname -I

# To test network connectivity from Kindle:
#   ping -c 1 192.168.50.163
#   wget --spider http://192.168.50.163:3000/health

# To check available storage space on Kindle:
#   df -h /mnt/us

# To view recent log entries:
#   tail -20 /mnt/us/dashboard/logs/fetch.log

# To test the configuration:
#   ./fetch-dashboard.sh --dry-run --verbose